<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="CSS・フロントエンドのパフォーマンス最適化手法を詳しく解説。Critical CSS、画像最適化、レンダリングブロッキングの回避など、高速なWebサイトを実現するテクニックを紹介します。"><title>CSS実践入門第9回：パフォーマンス最適化 - 高速読み込みとレンダリング最適化</title><link rel=canonical href=https://firebird-techtalktech.com/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80%E7%AC%AC9%E5%9B%9E%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9%E6%9C%80%E9%81%A9%E5%8C%96-%E9%AB%98%E9%80%9F%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%A8%E3%83%AC%E3%83%B3%E3%83%80%E3%83%AA%E3%83%B3%E3%82%B0%E6%9C%80%E9%81%A9%E5%8C%96/><link rel=stylesheet href=/scss/style.min.e6937209cf479aae8b2dc8dae2b126867e86dcb9029b922867e771b019f3d3d9.css><meta property='og:title' content="CSS実践入門第9回：パフォーマンス最適化 - 高速読み込みとレンダリング最適化"><meta property='og:description' content="CSS・フロントエンドのパフォーマンス最適化手法を詳しく解説。Critical CSS、画像最適化、レンダリングブロッキングの回避など、高速なWebサイトを実現するテクニックを紹介します。"><meta property='og:url' content='https://firebird-techtalktech.com/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80%E7%AC%AC9%E5%9B%9E%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9%E6%9C%80%E9%81%A9%E5%8C%96-%E9%AB%98%E9%80%9F%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%A8%E3%83%AC%E3%83%B3%E3%83%80%E3%83%AA%E3%83%B3%E3%82%B0%E6%9C%80%E9%81%A9%E5%8C%96/'><meta property='og:site_name' content='firebirdテックトーク'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='CSS'><meta property='article:tag' content='パフォーマンス最適化'><meta property='article:tag' content='Critical CSS'><meta property='article:tag' content='画像最適化'><meta property='article:tag' content='レンダリング最適化'><meta property='article:tag' content='Web Vitals'><meta property='article:published_time' content='2025-09-13T20:00:00+09:00'><meta property='article:modified_time' content='2025-09-13T20:00:00+09:00'><meta name=twitter:title content="CSS実践入門第9回：パフォーマンス最適化 - 高速読み込みとレンダリング最適化"><meta name=twitter:description content="CSS・フロントエンドのパフォーマンス最適化手法を詳しく解説。Critical CSS、画像最適化、レンダリングブロッキングの回避など、高速なWebサイトを実現するテクニックを紹介します。"><link rel="shortcut icon" href=/images/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-J8ND35KCZW"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-J8ND35KCZW")}</script><meta name=robots content="index,follow"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"firebirdテックトーク","url":"https:\/\/firebird-techtalktech.com\/","description":"技術ネタ、趣味や備忘録などを書いているブログです","publisher":{"@type":"Person","name":"トミー","url":"https:\/\/firebird-techtalktech.com\/about/"},"potentialAction":{"@type":"SearchAction","target":"https:\/\/firebird-techtalktech.com\/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"CSS実践入門第9回：パフォーマンス最適化 - 高速読み込みとレンダリング最適化","description":"CSS・フロントエンドのパフォーマンス最適化手法を詳しく解説。Critical CSS、画像最適化、レンダリングブロッキングの回避など、高速なWebサイトを実現するテクニックを紹介します。","author":{"@type":"Person","name":"トミー"},"publisher":{"@type":"Person","name":"トミー","url":"https:\/\/firebird-techtalktech.com\/about/"},"datePublished":"2025-09-13T20:00:00\u002b09:00","dateModified":"2025-09-13T20:00:00\u002b09:00","url":"https:\/\/firebird-techtalktech.com\/post\/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80%E7%AC%AC9%E5%9B%9E%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9%E6%9C%80%E9%81%A9%E5%8C%96-%E9%AB%98%E9%80%9F%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%A8%E3%83%AC%E3%83%B3%E3%83%80%E3%83%AA%E3%83%B3%E3%82%B0%E6%9C%80%E9%81%A9%E5%8C%96\/","wordCount":"4325","keywords":["CSS","パフォーマンス最適化","Critical CSS","画像最適化","レンダリング最適化","Web Vitals"]}</script><meta name=description content="CSS・フロントエンドのパフォーマンス最適化手法を詳しく解説。Critical CSS、画像最適化、レンダリングブロッキングの回避など、高速なWebサイトを実現するテクニックを紹介します。"><meta property="og:site_name" content="firebirdテックトーク"><meta property="og:type" content="article"><meta name=google-adsense-account content="ca-pub-8563231513969804"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8563231513969804" crossorigin=anonymous></script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><header class=site-header><div class=header-container><div class=header-brand><div class=header-logo><a href=/><img src=/img/avatar_hu_d7c67b01a0ed7653.png width=40 height=40 class=header-logo-img loading=lazy alt=Avatar></a></div><div class=header-title><h1 class=site-title><a href=/>firebirdテックトーク</a></h1><div class=site-tagline>技術ネタ、趣味や備忘録などを書いているブログです</div></div></div><div class=header-search><form class=search-form action=/search/ method=get><div class=search-wrapper><input type=text name=keyword placeholder=記事を検索... class=search-input autocomplete=off>
<button type=submit class=search-button>
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></button></div></form></div><nav class=header-nav><ul class=nav-menu><li class=nav-item><a href=/ class=nav-link>ホーム</a></li><li class=nav-item><a href=/tags/author-created/ class=nav-link>マイブログ</a></li><li class=nav-item><a href=/categories/%E6%97%85%E8%A1%8C%E8%A8%98/ class=nav-link>旅行記</a></li><li class=nav-item><a href=/categories/%E6%9C%80%E6%96%B0%E8%A8%98%E4%BA%8B/ class=nav-link>最新記事</a></li><li class=nav-item><a href=/tags/ class=nav-link>タグ一覧</a></li></ul></nav><button class=mobile-menu-toggle type=button aria-label=メニューを開く>
<span class=hamburger></span>
<span class=hamburger></span>
<span class=hamburger></span></button></div></header><style>.site-header{background:var(--card-background);border-bottom:1px solid var(--card-separator-color);position:sticky;top:0;z-index:1000;box-shadow:0 2px 8px rgba(0,0,0,.1)}.header-container{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;align-items:center;justify-content:space-between;height:60px;gap:20px}.header-brand{display:flex;align-items:center;gap:12px;flex-shrink:0}.header-logo-img{width:40px;height:40px;border-radius:50%;object-fit:cover}.header-title{display:flex;flex-direction:column;min-width:0}.site-title{margin:0;font-size:1.3em;font-weight:700;line-height:1}.site-title a{color:var(--card-text-color-main);text-decoration:none;transition:color .2s}.site-title a:hover{color:var(--accent-color)}.site-tagline{font-size:.8em;color:var(--card-text-color-secondary);margin-top:2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.header-search{flex:1;max-width:400px;margin:0 20px}.search-form{width:100%}.search-wrapper{position:relative;display:flex;align-items:center}.search-input{width:100%;padding:8px 40px 8px 12px;border:1px solid var(--card-separator-color);border-radius:20px;background:var(--body-background);color:var(--card-text-color-main);font-size:.9em;transition:all .2s}.search-input:focus{outline:none;border-color:var(--accent-color);box-shadow:0 0 0 2px var(--accent-color-light)}.search-button{position:absolute;right:8px;background:0 0;border:none;padding:4px;color:var(--card-text-color-tertiary);cursor:pointer;transition:color .2s}.search-button:hover{color:var(--accent-color)}.header-nav{flex-shrink:0}.nav-menu{display:flex;list-style:none;margin:0;padding:0;gap:20px}.nav-item{margin:0}.nav-link{color:var(--card-text-color-main);text-decoration:none;font-weight:500;font-size:.9em;transition:color .2s;white-space:nowrap}.nav-link:hover{color:var(--accent-color)}.mobile-menu-toggle{display:none;flex-direction:column;gap:3px;background:0 0;border:none;padding:8px;cursor:pointer}.hamburger{width:20px;height:2px;background:var(--card-text-color-main);transition:all .3s}@media(max-width:768px){.header-container{padding:0 15px;height:56px}.header-search{order:3;flex:1;margin:0;max-width:none}.header-nav{display:none}.mobile-menu-toggle{display:flex;order:2}.site-tagline{display:none}.site-title{font-size:1.1em}}@media(max-width:480px){.header-container{gap:10px}.header-brand{gap:8px}.header-logo-img{width:32px;height:32px}.site-title{font-size:1em}}</style><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=メニューを開く・閉じる>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><div class=media-sidebar-content></div></aside><style>.left-sidebar-widgets{margin-top:10px;padding:15px}.left-sidebar-widgets .popular-tags-widget{margin-bottom:0}.left-sidebar-widgets .popular-tags-widget .widget-title{font-size:1rem;margin-bottom:15px;color:var(--accent-color);border-bottom:2px solid var(--accent-color);padding-bottom:8px}.media-sidebar-content{margin-top:10px;padding-top:10px}.media-sidebar-content .widget{margin-bottom:20px;padding:12px;background:var(--body-background);border-radius:6px;border:1px solid var(--card-separator-color)}.media-sidebar-content .widget .widget-title{font-size:.95em;margin-bottom:12px;color:var(--accent-color);border-bottom:1px solid var(--accent-color);padding-bottom:6px}.media-sidebar-content .topic-section{margin-bottom:15px}.media-sidebar-content .media-section{margin-bottom:15px;padding-bottom:12px}.media-sidebar-content .topic-title,.media-sidebar-content .media-title{font-size:.9em;margin-bottom:8px}.media-sidebar-content .topic-item,.media-sidebar-content .featured-item{margin-bottom:8px;padding:6px}.media-sidebar-content .trend-tag,.media-sidebar-content .guide-item,.media-sidebar-content .topic-category{padding:6px 8px}.media-sidebar-content .breaking-item{padding:8px}.media-sidebar-content .pickup-item{padding:8px}@media(max-width:1024px){.media-sidebar-content{display:none}}@media(min-width:1024px){.left-sidebar{width:300px;min-width:300px}}</style><aside class="sidebar right-sidebar sticky"><section class="widget ad-widget"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></div><h2 class="widget-title section-title">スポンサーリンク</h2><div class=widget-content><div class="ad-container ad-sidebar"></div></div></section><style>.ad-widget{margin-bottom:8px;padding:0}.ad-widget .widget-icon{margin-bottom:4px;display:none}.ad-widget .widget-title{margin-bottom:6px;font-size:.8em;text-align:center}.ad-container{display:flex;justify-content:center;align-items:center;min-height:auto;padding:0;margin:0}.ad-sidebar{width:100%;max-width:320px;margin:0 auto;line-height:0}.ad-sidebar img{max-width:100%;height:auto;border-radius:6px;display:block;margin:0;padding:0}@media(max-width:768px){.ad-container{max-width:100%}.ad-sidebar{max-width:100%}}[data-scheme=dark] .ad-placeholder{background:var(--card-background)!important;border-color:var(--card-separator-color)!important;color:var(--card-text-color-secondary)!important}</style><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目次</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#この記事で学べること>この記事で学べること</a></li><li><a href=#1-critical-css-の実装>1. Critical CSS の実装</a><ol><li><a href=#critical-css-の基本概念>Critical CSS の基本概念</a></li><li><a href=#自動-critical-css-抽出>自動 Critical CSS 抽出</a></li></ol></li><li><a href=#2-画像最適化とレスポンシブ画像>2. 画像最適化とレスポンシブ画像</a><ol><li><a href=#次世代画像フォーマット対応>次世代画像フォーマット対応</a></li><li><a href=#画像遅延読み込みの実装>画像遅延読み込みの実装</a></li><li><a href=#intersection-observer-による遅延読み込み>Intersection Observer による遅延読み込み</a></li></ol></li><li><a href=#3-レンダリング最適化>3. レンダリング最適化</a><ol><li><a href=#レイアウトシフトの最小化>レイアウトシフトの最小化</a></li><li><a href=#gpu-アクセラレーションの活用>GPU アクセラレーションの活用</a></li></ol></li><li><a href=#4-css-バンドル最適化>4. CSS バンドル最適化</a><ol><li><a href=#未使用-css-の削除>未使用 CSS の削除</a></li><li><a href=#css-の分割と遅延読み込み>CSS の分割と遅延読み込み</a></li></ol></li><li><a href=#5-javascript-最適化>5. JavaScript 最適化</a><ol><li><a href=#コード分割と遅延読み込み>コード分割と遅延読み込み</a></li><li><a href=#service-worker-による-キャッシュ最適化>Service Worker による キャッシュ最適化</a></li></ol></li><li><a href=#6-パフォーマンス測定と監視>6. パフォーマンス測定と監視</a><ol><li><a href=#web-vitals-の測定>Web Vitals の測定</a></li><li><a href=#バンドル分析とビルド最適化>バンドル分析とビルド最適化</a></li></ol></li><li><a href=#まとめ>まとめ</a><ol><li><a href=#主要な最適化ポイント>主要な最適化ポイント</a></li><li><a href=#継続的な改善プロセス>継続的な改善プロセス</a></li><li><a href=#開発ワークフローへの統合>開発ワークフローへの統合</a></li></ol></li></ol></nav></div></section><section class="widget tagCloud"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">カテゴリ</h2><div class=tagCloud-tags><a href=/categories/%E3%83%9E%E3%82%A4%E3%83%96%E3%83%AD%E3%82%B0/ class=font_size_87>マイブログ
</a><a href=/categories/%E6%97%85%E8%A1%8C%E8%A8%98/ class=font_size_15>旅行記</a></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E3%83%9E%E3%82%A4%E3%83%96%E3%83%AD%E3%82%B0/>マイブログ</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80%E7%AC%AC9%E5%9B%9E%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9%E6%9C%80%E9%81%A9%E5%8C%96-%E9%AB%98%E9%80%9F%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%A8%E3%83%AC%E3%83%B3%E3%83%80%E3%83%AA%E3%83%B3%E3%82%B0%E6%9C%80%E9%81%A9%E5%8C%96/>CSS実践入門第9回：パフォーマンス最適化 - 高速読み込みとレンダリング最適化</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025年9月13日</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>読了時間: 9分</time></div></footer></div></header><section class=article-content><p>Webサイトのパフォーマンスは、ユーザーエクスペリエンスとSEOの両面で極めて重要な要素です。今回は、CSS・フロントエンド技術を活用したパフォーマンス最適化の実践的な手法を詳しく解説し、高速で快適なWebサイトを構築するテクニックを紹介します。</p><h2 id=この記事で学べること>この記事で学べること</h2><ul><li>Critical CSS による初期レンダリング高速化</li><li>画像最適化と遅延読み込みの実装</li><li>レンダリングブロッキングの回避技術</li><li>CSS・JavaScript バンドルサイズの最適化</li><li>Core Web Vitals の改善手法</li></ul><h2 id=1-critical-css-の実装>1. Critical CSS の実装</h2><h3 id=critical-css-の基本概念>Critical CSS の基本概念</h3><p>Critical CSS は、ファーストビューの表示に必要な最小限のCSSのみを抽出し、HTMLに直接埋め込む手法です。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;ja&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width, initial-scale=1.0&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>パフォーマンス最適化サイト<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Critical CSS をインライン挿入 --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>/* ファーストビュー用の最小限CSS */</span>
</span></span><span class=line><span class=cl>        <span class=p>:</span><span class=nd>root</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>--primary-color</span><span class=p>:</span> <span class=mh>#3498db</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nv>--text-color</span><span class=p>:</span> <span class=mh>#2c3e50</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nv>--background-color</span><span class=p>:</span> <span class=mh>#ffffff</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>box-sizing</span><span class=p>:</span> <span class=kc>border-box</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>font-family</span><span class=p>:</span> <span class=o>-</span><span class=n>apple-system</span><span class=p>,</span> <span class=n>BlinkMacSystemFont</span><span class=p>,</span> <span class=s1>&#39;Segoe UI&#39;</span><span class=p>,</span> <span class=n>Roboto</span><span class=p>,</span> <span class=kc>sans-serif</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>font-size</span><span class=p>:</span> <span class=mi>16</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>line-height</span><span class=p>:</span> <span class=mf>1.6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=kc>text</span><span class=o>-</span><span class=kc>color</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>background-color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>background</span><span class=o>-</span><span class=kc>color</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>header</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>primary</span><span class=o>-</span><span class=kc>color</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>color</span><span class=p>:</span> <span class=kc>white</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>1</span><span class=kt>rem</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>position</span><span class=p>:</span> <span class=kc>sticky</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>top</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>z-index</span><span class=p>:</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>container</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>max-width</span><span class=p>:</span> <span class=mi>1200</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span> <span class=kc>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span> <span class=mi>1</span><span class=kt>rem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>hero</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=nb>linear-gradient</span><span class=p>(</span><span class=mi>135</span><span class=kt>deg</span><span class=p>,</span> <span class=mh>#667eea</span> <span class=mi>0</span><span class=kt>%</span><span class=p>,</span> <span class=mh>#764ba2</span> <span class=mi>100</span><span class=kt>%</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>color</span><span class=p>:</span> <span class=kc>white</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>4</span><span class=kt>rem</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>text-align</span><span class=p>:</span> <span class=kc>center</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>hero</span> <span class=nt>h1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>font-size</span><span class=p>:</span> <span class=mf>2.5</span><span class=kt>rem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin-bottom</span><span class=p>:</span> <span class=mi>1</span><span class=kt>rem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>font-weight</span><span class=p>:</span> <span class=mi>700</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>hero</span> <span class=nt>p</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>font-size</span><span class=p>:</span> <span class=mf>1.2</span><span class=kt>rem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin-bottom</span><span class=p>:</span> <span class=mi>2</span><span class=kt>rem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>opacity</span><span class=p>:</span> <span class=mf>0.9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- メインCSS を非同期読み込み --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;preload&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/css/main.css&#34;</span> <span class=na>as</span><span class=o>=</span><span class=s>&#34;style&#34;</span> <span class=na>onload</span><span class=o>=</span><span class=s>&#34;this.onload=null;this.rel=&#39;stylesheet&#39;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>noscript</span><span class=p>&gt;&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/css/main.css&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>noscript</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>header</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;header&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>nav</span><span class=p>&gt;</span><span class=c>&lt;!-- ナビゲーション --&gt;</span><span class=p>&lt;/</span><span class=nt>nav</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>section</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;hero&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>高速Webサイト<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>パフォーマンス最適化の実践<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 残りのコンテンツ --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=自動-critical-css-抽出>自動 Critical CSS 抽出</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Critical CSS 抽出ツール（Node.js）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>critical</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;critical&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;path&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>generateCriticalCSS</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>critical</span><span class=p>.</span><span class=nx>generate</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=c1>// ベースとなるHTML
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>base</span><span class=o>:</span> <span class=s1>&#39;dist/&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>src</span><span class=o>:</span> <span class=s1>&#39;index.html&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>dest</span><span class=o>:</span> <span class=s1>&#39;index-critical.html&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// CSS ファイル
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>css</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;css/main.css&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// ビューポートサイズ
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>dimensions</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>height</span><span class=o>:</span> <span class=mi>900</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>width</span><span class=o>:</span> <span class=mi>1300</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>height</span><span class=o>:</span> <span class=mi>720</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>width</span><span class=o>:</span> <span class=mi>414</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 抽出設定
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>penthouse</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>blockJSRequests</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// インライン挿入
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>inline</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 元のCSS削除
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>extract</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 最小化
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>minify</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 無視するCSS
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>ignore</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>atrule</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;@font-face&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>rule</span><span class=o>:</span> <span class=p>[</span><span class=sr>/some-unused-class/</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>decl</span><span class=o>:</span> <span class=p>(</span><span class=nx>node</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=sr>/\.sr-only/</span><span class=p>.</span><span class=nx>test</span><span class=p>(</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Critical CSS generated successfully!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Critical CSS generation failed:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>generateCriticalCSS</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=2-画像最適化とレスポンシブ画像>2. 画像最適化とレスポンシブ画像</h2><h3 id=次世代画像フォーマット対応>次世代画像フォーマット対応</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- WebP/AVIF 対応のレスポンシブ画像 --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>picture</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>source</span> 
</span></span><span class=line><span class=cl>        <span class=na>srcset</span><span class=o>=</span><span class=s>&#34;image-320.avif 320w, image-640.avif 640w, image-960.avif 960w, image-1280.avif 1280w&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 25vw&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>type</span><span class=o>=</span><span class=s>&#34;image/avif&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>source</span> 
</span></span><span class=line><span class=cl>        <span class=na>srcset</span><span class=o>=</span><span class=s>&#34;image-320.webp 320w, image-640.webp 640w, image-960.webp 960w, image-1280.webp 1280w&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 25vw&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>type</span><span class=o>=</span><span class=s>&#34;image/webp&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>img</span> 
</span></span><span class=line><span class=cl>        <span class=na>src</span><span class=o>=</span><span class=s>&#34;image-640.jpg&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>srcset</span><span class=o>=</span><span class=s>&#34;image-320.jpg 320w, image-640.jpg 640w, image-960.jpg 960w, image-1280.jpg 1280w&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 25vw&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>alt</span><span class=o>=</span><span class=s>&#34;最適化された画像&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>loading</span><span class=o>=</span><span class=s>&#34;lazy&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>decoding</span><span class=o>=</span><span class=s>&#34;async&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>picture</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=画像遅延読み込みの実装>画像遅延読み込みの実装</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* 遅延読み込み画像の初期状態 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>lazy-image</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>opacity</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>transition</span><span class=p>:</span> <span class=k>opacity</span> <span class=mf>0.3</span><span class=kt>s</span> <span class=kc>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>background-color</span><span class=p>:</span> <span class=mh>#f0f0f0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>lazy-image</span><span class=p>.</span><span class=nc>loaded</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>opacity</span><span class=p>:</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* スケルトンローダー */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>image-skeleton</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>background</span><span class=p>:</span> <span class=nb>linear-gradient</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=mi>90</span><span class=kt>deg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>#f0f0f0</span> <span class=mi>25</span><span class=kt>%</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>#e0e0e0</span> <span class=mi>50</span><span class=kt>%</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>#f0f0f0</span> <span class=mi>75</span><span class=kt>%</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>background-size</span><span class=p>:</span> <span class=mi>200</span><span class=kt>%</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>animation</span><span class=p>:</span> <span class=n>skeleton-loading</span> <span class=mf>1.5</span><span class=kt>s</span> <span class=kc>infinite</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>@</span><span class=k>keyframes</span> <span class=nt>skeleton-loading</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>0</span><span class=o>%</span> <span class=p>{</span> <span class=k>background-position</span><span class=p>:</span> <span class=mi>200</span><span class=kt>%</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nt>100</span><span class=o>%</span> <span class=p>{</span> <span class=k>background-position</span><span class=p>:</span> <span class=mi>-200</span><span class=kt>%</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* ぼかしエフェクト付きプレースホルダー */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>lazy-blur</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>filter</span><span class=p>:</span> <span class=nb>blur</span><span class=p>(</span><span class=mi>5</span><span class=kt>px</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>scale</span><span class=p>(</span><span class=mf>1.05</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>transition</span><span class=p>:</span> <span class=kc>all</span> <span class=mf>0.3</span><span class=kt>s</span> <span class=kc>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>lazy-blur</span><span class=p>.</span><span class=nc>loaded</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>filter</span><span class=p>:</span> <span class=nb>blur</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>scale</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=intersection-observer-による遅延読み込み>Intersection Observer による遅延読み込み</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>LazyImageLoader</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>rootMargin</span><span class=o>:</span> <span class=s1>&#39;50px 0px&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>threshold</span><span class=o>:</span> <span class=mf>0.01</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>enableBlur</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>...</span><span class=nx>options</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>imageObserver</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>IntersectionObserver</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>handleImageIntersection</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>rootMargin</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>rootMargin</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>threshold</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>threshold</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>init</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>lazyImages</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;img[data-src]&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>lazyImages</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>img</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>setupImage</span><span class=p>(</span><span class=nx>img</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>imageObserver</span><span class=p>.</span><span class=nx>observe</span><span class=p>(</span><span class=nx>img</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>setupImage</span><span class=p>(</span><span class=nx>img</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>img</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;lazy-image&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 低品質プレースホルダー
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>img</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>placeholder</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>img</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>img</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>placeholder</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>enableBlur</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>img</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;lazy-blur&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>img</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;image-skeleton&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>handleImageIntersection</span><span class=p>(</span><span class=nx>entries</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>entries</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>entry</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>entry</span><span class=p>.</span><span class=nx>isIntersecting</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>loadImage</span><span class=p>(</span><span class=nx>entry</span><span class=p>.</span><span class=nx>target</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>imageObserver</span><span class=p>.</span><span class=nx>unobserve</span><span class=p>(</span><span class=nx>entry</span><span class=p>.</span><span class=nx>target</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>loadImage</span><span class=p>(</span><span class=nx>img</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>src</span> <span class=o>=</span> <span class=nx>img</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>src</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>srcset</span> <span class=o>=</span> <span class=nx>img</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>srcset</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 画像プリロード
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>imageLoader</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Image</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>srcset</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>imageLoader</span><span class=p>.</span><span class=nx>srcset</span> <span class=o>=</span> <span class=nx>srcset</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>imageLoader</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>src</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 画像読み込み完了を待つ
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>imageLoader</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=nx>resolve</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>imageLoader</span><span class=p>.</span><span class=nx>onerror</span> <span class=o>=</span> <span class=nx>reject</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 画像を適用
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=nx>srcset</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>img</span><span class=p>.</span><span class=nx>srcset</span> <span class=o>=</span> <span class=nx>srcset</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>img</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>src</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// ロード完了時の処理
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>img</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>img</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;loaded&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>img</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>remove</span><span class=p>(</span><span class=s1>&#39;lazy-blur&#39;</span><span class=p>,</span> <span class=s1>&#39;image-skeleton&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Image loading failed:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>img</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;image-error&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 初期化
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;DOMContentLoaded&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>LazyImageLoader</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>rootMargin</span><span class=o>:</span> <span class=s1>&#39;100px 0px&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>enableBlur</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=3-レンダリング最適化>3. レンダリング最適化</h2><h3 id=レイアウトシフトの最小化>レイアウトシフトの最小化</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* アスペクト比によるレイアウト予約 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>aspect-ratio</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>position</span><span class=p>:</span> <span class=kc>relative</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>aspect-ratio</span><span class=p>::</span><span class=nd>before</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>content</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>display</span><span class=p>:</span> <span class=kc>block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>padding-top</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>aspect</span><span class=o>-</span><span class=n>ratio</span><span class=p>,</span> <span class=mf>56.25</span><span class=kt>%</span><span class=p>);</span> <span class=c>/* 16:9 = 56.25% */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>aspect-ratio</span> <span class=o>&gt;</span> <span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>top</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>left</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>object-fit</span><span class=p>:</span> <span class=kc>cover</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* 様々なアスペクト比 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>aspect-16-9</span> <span class=p>{</span> <span class=nv>--aspect-ratio</span><span class=p>:</span> <span class=mf>56.25</span><span class=kt>%</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>aspect-4-3</span> <span class=p>{</span> <span class=nv>--aspect-ratio</span><span class=p>:</span> <span class=mi>75</span><span class=kt>%</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>aspect-1-1</span> <span class=p>{</span> <span class=nv>--aspect-ratio</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>aspect-3-2</span> <span class=p>{</span> <span class=nv>--aspect-ratio</span><span class=p>:</span> <span class=mf>66.67</span><span class=kt>%</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* CSS aspect-ratio プロパティ（モダンブラウザ） */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>modern-aspect</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>aspect-ratio</span><span class=p>:</span> <span class=mi>16</span> <span class=o>/</span> <span class=mi>9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>height</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* フォント読み込み中のレイアウトシフト対策 */</span>
</span></span><span class=line><span class=cl><span class=p>@</span><span class=k>font-face</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>font-family</span><span class=o>:</span> <span class=s1>&#39;CustomFont&#39;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nt>src</span><span class=o>:</span> <span class=nt>url</span><span class=o>(</span><span class=s1>&#39;custom-font.woff2&#39;</span><span class=o>)</span> <span class=nt>format</span><span class=o>(</span><span class=s1>&#39;woff2&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=nt>font-display</span><span class=o>:</span> <span class=nt>swap</span><span class=o>;</span> <span class=c>/* フォールバックフォントを即座に表示 */</span>
</span></span><span class=line><span class=cl>    <span class=nt>size-adjust</span><span class=o>:</span> <span class=nt>100</span><span class=o>%;</span> <span class=c>/* サイズ調整でレイアウトシフトを最小化 */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* システムフォントスタック */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>font-system</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>font-family</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>        <span class=o>-</span><span class=n>apple-system</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>BlinkMacSystemFont</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Segoe UI&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Roboto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Oxygen&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Ubuntu&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Cantarell&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Fira Sans&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Droid Sans&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Helvetica Neue&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kc>sans-serif</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=gpu-アクセラレーションの活用>GPU アクセラレーションの活用</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* GPU で処理されるプロパティを優先使用 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>gpu-optimized</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* transform, opacity は GPU で高速処理 */</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>translateZ</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span> <span class=c>/* ハードウェアアクセラレーション強制 */</span>
</span></span><span class=line><span class=cl>    <span class=k>will-change</span><span class=p>:</span> <span class=k>transform</span><span class=p>,</span> <span class=k>opacity</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* 避けるべき重いプロパティ */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>cpu-heavy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* これらは CPU で処理され、重い */</span>
</span></span><span class=line><span class=cl>    <span class=c>/* width, height, top, left, margin, padding, border-width */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* transform を使った代替実装 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>efficient-animations</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* width の代わりに scaleX */</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>scaleX</span><span class=p>(</span><span class=mf>0.8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c>/* position の代わりに translate */</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>translateX</span><span class=p>(</span><span class=mi>100</span><span class=kt>px</span><span class=p>)</span> <span class=nb>translateY</span><span class=p>(</span><span class=mi>50</span><span class=kt>px</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c>/* 複数の transform を組み合わせ */</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>translateX</span><span class=p>(</span><span class=mi>100</span><span class=kt>px</span><span class=p>)</span> <span class=nb>rotate</span><span class=p>(</span><span class=mi>45</span><span class=kt>deg</span><span class=p>)</span> <span class=nb>scale</span><span class=p>(</span><span class=mf>1.2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* containment による最適化 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>contained-component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>contain</span><span class=p>:</span> <span class=n>layout</span> <span class=kc>style</span> <span class=n>paint</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>strictly-contained</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>contain</span><span class=p>:</span> <span class=kc>strict</span><span class=p>;</span> <span class=c>/* layout + style + paint + size の組み合わせ */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=4-css-バンドル最適化>4. CSS バンドル最適化</h2><h3 id=未使用-css-の削除>未使用 CSS の削除</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// PurgeCSS 設定例
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>purgecss</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@fullhuman/postcss-purgecss&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>plugins</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=nx>purgecss</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>content</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;./src/**/*.html&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;./src/**/*.js&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;./src/**/*.vue&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 保持するクラス（動的に生成される）
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>safelist</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>standard</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;active&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;disabled&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;loading&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=sr>/^swiper-/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=sr>/^aos-/</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>deep</span><span class=o>:</span> <span class=p>[</span><span class=sr>/^modal-/</span><span class=p>,</span> <span class=sr>/^tooltip-/</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>greedy</span><span class=o>:</span> <span class=p>[</span><span class=sr>/^ripple-/</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// カスタム抽出器
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>extractors</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>extractor</span><span class=o>:</span> <span class=nx>content</span> <span class=p>=&gt;</span> <span class=nx>content</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=sr>/[\w-/:]+(?&lt;!:)/g</span><span class=p>)</span> <span class=o>||</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>extensions</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;html&#39;</span><span class=p>,</span> <span class=s1>&#39;js&#39;</span><span class=p>,</span> <span class=s1>&#39;vue&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 削除しないセレクター
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>rejected</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>printRejected</span><span class=o>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// CSS 最小化
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;cssnano&#39;</span><span class=p>)({</span>
</span></span><span class=line><span class=cl>            <span class=nx>preset</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;default&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>discardComments</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nx>removeAll</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=css-の分割と遅延読み込み>CSS の分割と遅延読み込み</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* コンポーネント別 CSS 分割 */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* critical.css - ファーストビュー用 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>header</span><span class=o>,</span> <span class=p>.</span><span class=nc>nav</span><span class=o>,</span> <span class=p>.</span><span class=nc>hero</span><span class=o>,</span> <span class=p>.</span><span class=nc>container</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* 重要なスタイル */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* components.css - コンポーネント用 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>button</span><span class=o>,</span> <span class=p>.</span><span class=nc>card</span><span class=o>,</span> <span class=p>.</span><span class=nc>modal</span><span class=o>,</span> <span class=p>.</span><span class=nc>dropdown</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* コンポーネントスタイル */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* utilities.css - ユーティリティ用 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>text-center</span><span class=o>,</span> <span class=p>.</span><span class=nc>mb-4</span><span class=o>,</span> <span class=p>.</span><span class=nc>d-flex</span><span class=o>,</span> <span class=p>.</span><span class=nc>justify-center</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* ユーティリティスタイル */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// CSS の動的読み込み
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>CSSLoader</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>static</span> <span class=nx>loadedStylesheets</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Set</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>static</span> <span class=kr>async</span> <span class=nx>loadCSS</span><span class=p>(</span><span class=nx>href</span><span class=p>,</span> <span class=nx>media</span> <span class=o>=</span> <span class=s1>&#39;all&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>loadedStylesheets</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>href</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>link</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;link&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>link</span><span class=p>.</span><span class=nx>rel</span> <span class=o>=</span> <span class=s1>&#39;stylesheet&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>link</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>link</span><span class=p>.</span><span class=nx>media</span> <span class=o>=</span> <span class=nx>media</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nx>link</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>loadedStylesheets</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>href</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nx>link</span><span class=p>.</span><span class=nx>onerror</span> <span class=o>=</span> <span class=nx>reject</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>document</span><span class=p>.</span><span class=nx>head</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>link</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// コンポーネント使用時の CSS 読み込み
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>static</span> <span class=kr>async</span> <span class=nx>loadComponentCSS</span><span class=p>(</span><span class=nx>componentName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>cssMap</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;modal&#39;</span><span class=o>:</span> <span class=s1>&#39;/css/components/modal.css&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;carousel&#39;</span><span class=o>:</span> <span class=s1>&#39;/css/components/carousel.css&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;chart&#39;</span><span class=o>:</span> <span class=s1>&#39;/css/components/chart.css&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>cssPath</span> <span class=o>=</span> <span class=nx>cssMap</span><span class=p>[</span><span class=nx>componentName</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>cssPath</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>loadCSS</span><span class=p>(</span><span class=nx>cssPath</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 使用例
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>ModalComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>show</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// モーダル表示前に CSS を読み込み
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>await</span> <span class=nx>CSSLoader</span><span class=p>.</span><span class=nx>loadComponentCSS</span><span class=p>(</span><span class=s1>&#39;modal&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// モーダル表示処理
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>element</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;modal--active&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=5-javascript-最適化>5. JavaScript 最適化</h2><h3 id=コード分割と遅延読み込み>コード分割と遅延読み込み</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 動的インポートによるコード分割
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>ComponentLoader</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>static</span> <span class=nx>componentCache</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>static</span> <span class=kr>async</span> <span class=nx>loadComponent</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>componentCache</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>name</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>componentCache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>component</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=s1>&#39;search&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=nx>component</span> <span class=o>=</span> <span class=kr>await</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;./components/SearchComponent.js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=s1>&#39;chart&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=nx>component</span> <span class=o>=</span> <span class=kr>await</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;./components/ChartComponent.js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=s1>&#39;carousel&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=nx>component</span> <span class=o>=</span> <span class=kr>await</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;./components/CarouselComponent.js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`Unknown component: </span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>componentCache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>component</span><span class=p>.</span><span class=k>default</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>component</span><span class=p>.</span><span class=k>default</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Intersection Observer で必要時に読み込み
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>LazyComponentLoader</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>componentObserver</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>IntersectionObserver</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>handleComponentIntersection</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span> <span class=nx>rootMargin</span><span class=o>:</span> <span class=s1>&#39;100px 0px&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>init</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;[data-component]&#39;</span><span class=p>).</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>element</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>componentObserver</span><span class=p>.</span><span class=nx>observe</span><span class=p>(</span><span class=nx>element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>handleComponentIntersection</span><span class=p>(</span><span class=nx>entries</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>entry</span> <span class=k>of</span> <span class=nx>entries</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>entry</span><span class=p>.</span><span class=nx>isIntersecting</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>element</span> <span class=o>=</span> <span class=nx>entry</span><span class=p>.</span><span class=nx>target</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>componentName</span> <span class=o>=</span> <span class=nx>element</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>component</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kr>const</span> <span class=nx>Component</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>ComponentLoader</span><span class=p>.</span><span class=nx>loadComponent</span><span class=p>(</span><span class=nx>componentName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>new</span> <span class=nx>Component</span><span class=p>(</span><span class=nx>element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>componentObserver</span><span class=p>.</span><span class=nx>unobserve</span><span class=p>(</span><span class=nx>element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`Failed to load component </span><span class=si>${</span><span class=nx>componentName</span><span class=si>}</span><span class=sb>:`</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 初期化
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;DOMContentLoaded&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>LazyComponentLoader</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=service-worker-による-キャッシュ最適化>Service Worker による キャッシュ最適化</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// service-worker.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>CACHE_NAME</span> <span class=o>=</span> <span class=s1>&#39;site-cache-v1&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>STATIC_CACHE_URLS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;/&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;/css/critical.css&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;/js/main.js&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;/images/logo.svg&#39;</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// インストール時の処理
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;install&#39;</span><span class=p>,</span> <span class=nx>event</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>event</span><span class=p>.</span><span class=nx>waitUntil</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>caches</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=nx>CACHE_NAME</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>cache</span> <span class=p>=&gt;</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>addAll</span><span class=p>(</span><span class=nx>STATIC_CACHE_URLS</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>self</span><span class=p>.</span><span class=nx>skipWaiting</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// フェッチ時の処理
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;fetch&#39;</span><span class=p>,</span> <span class=nx>event</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// CSS・JS・画像の キャッシュ戦略
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>.</span><span class=nx>destination</span> <span class=o>===</span> <span class=s1>&#39;style&#39;</span> <span class=o>||</span> 
</span></span><span class=line><span class=cl>        <span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>.</span><span class=nx>destination</span> <span class=o>===</span> <span class=s1>&#39;script&#39;</span> <span class=o>||</span> 
</span></span><span class=line><span class=cl>        <span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>.</span><span class=nx>destination</span> <span class=o>===</span> <span class=s1>&#39;image&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>event</span><span class=p>.</span><span class=nx>respondWith</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>caches</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=nx>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                            <span class=kr>const</span> <span class=nx>responseClone</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>clone</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                            <span class=nx>caches</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=nx>CACHE_NAME</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>cache</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                                    <span class=nx>cache</span><span class=p>.</span><span class=nx>put</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>,</span> <span class=nx>responseClone</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                                <span class=p>});</span>
</span></span><span class=line><span class=cl>                            <span class=k>return</span> <span class=nx>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=p>});</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// メインスレッドでの Service Worker 登録
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=s1>&#39;serviceWorker&#39;</span> <span class=k>in</span> <span class=nx>navigator</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;load&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>navigator</span><span class=p>.</span><span class=nx>serviceWorker</span><span class=p>.</span><span class=nx>register</span><span class=p>(</span><span class=s1>&#39;/service-worker.js&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>registration</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;SW registered: &#39;</span><span class=p>,</span> <span class=nx>registration</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>registrationError</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;SW registration failed: &#39;</span><span class=p>,</span> <span class=nx>registrationError</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=6-パフォーマンス測定と監視>6. パフォーマンス測定と監視</h2><h3 id=web-vitals-の測定>Web Vitals の測定</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Core Web Vitals の測定
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span><span class=nx>getLCP</span><span class=p>,</span> <span class=nx>getFID</span><span class=p>,</span> <span class=nx>getCLS</span><span class=p>,</span> <span class=nx>getFCP</span><span class=p>,</span> <span class=nx>getTTFB</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;web-vitals&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>PerformanceMonitor</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>reportEndpoint</span><span class=o>:</span> <span class=s1>&#39;/api/performance&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>sampleRate</span><span class=o>:</span> <span class=mf>0.1</span><span class=p>,</span> <span class=c1>// 10%のサンプリング
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>...</span><span class=nx>options</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>init</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// サンプリング判定
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>sampleRate</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Core Web Vitals の測定
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>getLCP</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>handleMetric</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=s1>&#39;LCP&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=nx>getFID</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>handleMetric</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=s1>&#39;FID&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=nx>getCLS</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>handleMetric</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=s1>&#39;CLS&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=nx>getFCP</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>handleMetric</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=s1>&#39;FCP&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=nx>getTTFB</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>handleMetric</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=s1>&#39;TTFB&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// ページアンロード時にレポート送信
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;beforeunload&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>sendReport</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>handleMetric</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>[</span><span class=nx>name</span><span class=p>]</span> <span class=o>=</span> <span class=nx>metric</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// リアルタイム分析
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>analyzeMetric</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>analyzeMetric</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>thresholds</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>LCP</span><span class=o>:</span> <span class=p>{</span> <span class=nx>good</span><span class=o>:</span> <span class=mi>2500</span><span class=p>,</span> <span class=nx>poor</span><span class=o>:</span> <span class=mi>4000</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>FID</span><span class=o>:</span> <span class=p>{</span> <span class=nx>good</span><span class=o>:</span> <span class=mi>100</span><span class=p>,</span> <span class=nx>poor</span><span class=o>:</span> <span class=mi>300</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>CLS</span><span class=o>:</span> <span class=p>{</span> <span class=nx>good</span><span class=o>:</span> <span class=mf>0.1</span><span class=p>,</span> <span class=nx>poor</span><span class=o>:</span> <span class=mf>0.25</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>FCP</span><span class=o>:</span> <span class=p>{</span> <span class=nx>good</span><span class=o>:</span> <span class=mi>1800</span><span class=p>,</span> <span class=nx>poor</span><span class=o>:</span> <span class=mi>3000</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>TTFB</span><span class=o>:</span> <span class=p>{</span> <span class=nx>good</span><span class=o>:</span> <span class=mi>800</span><span class=p>,</span> <span class=nx>poor</span><span class=o>:</span> <span class=mi>1800</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>threshold</span> <span class=o>=</span> <span class=nx>thresholds</span><span class=p>[</span><span class=nx>name</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>rating</span> <span class=o>=</span> <span class=s1>&#39;good&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>value</span> <span class=o>&gt;</span> <span class=nx>threshold</span><span class=p>.</span><span class=nx>poor</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>rating</span> <span class=o>=</span> <span class=s1>&#39;poor&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>value</span> <span class=o>&gt;</span> <span class=nx>threshold</span><span class=p>.</span><span class=nx>good</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>rating</span> <span class=o>=</span> <span class=s1>&#39;needs-improvement&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>: </span><span class=si>${</span><span class=nx>metric</span><span class=p>.</span><span class=nx>value</span><span class=si>}</span><span class=sb> (</span><span class=si>${</span><span class=nx>rating</span><span class=si>}</span><span class=sb>)`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// パフォーマンス問題の警告
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>rating</span> <span class=o>===</span> <span class=s1>&#39;poor&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>reportPerformanceIssue</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>reportPerformanceIssue</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 開発者向け警告
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>console</span><span class=p>.</span><span class=nx>warn</span><span class=p>(</span><span class=sb>`Performance issue detected: </span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb> = </span><span class=si>${</span><span class=nx>metric</span><span class=p>.</span><span class=nx>value</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 改善提案
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>suggestions</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>LCP</span><span class=o>:</span> <span class=s1>&#39;Consider optimizing images, reducing server response time, or implementing Critical CSS&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>FID</span><span class=o>:</span> <span class=s1>&#39;Consider reducing JavaScript execution time or implementing code splitting&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>CLS</span><span class=o>:</span> <span class=s1>&#39;Ensure images and ads have dimensions set, and avoid inserting content above existing content&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>FCP</span><span class=o>:</span> <span class=s1>&#39;Consider reducing render-blocking resources or implementing Critical CSS&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>TTFB</span><span class=o>:</span> <span class=s1>&#39;Consider optimizing server response time or using a CDN&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=sb>`Suggestion for </span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>: </span><span class=si>${</span><span class=nx>suggestions</span><span class=p>[</span><span class=nx>name</span><span class=p>]</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>sendReport</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>).</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>reportData</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>url</span><span class=o>:</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>userAgent</span><span class=o>:</span> <span class=nx>navigator</span><span class=p>.</span><span class=nx>userAgent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>connectionType</span><span class=o>:</span> <span class=nx>navigator</span><span class=p>.</span><span class=nx>connection</span><span class=o>?</span><span class=p>.</span><span class=nx>effectiveType</span> <span class=o>||</span> <span class=s1>&#39;unknown&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>metrics</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>timestamp</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Beacon API で確実に送信
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=nx>navigator</span><span class=p>.</span><span class=nx>sendBeacon</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>navigator</span><span class=p>.</span><span class=nx>sendBeacon</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>reportEndpoint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>reportData</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// フォールバック
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>reportEndpoint</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>body</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>reportData</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=nx>keepalive</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Failed to send performance report:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 初期化
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;DOMContentLoaded&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>PerformanceMonitor</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>sampleRate</span><span class=o>:</span> <span class=mf>0.1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>reportEndpoint</span><span class=o>:</span> <span class=s1>&#39;/api/performance&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=バンドル分析とビルド最適化>バンドル分析とビルド最適化</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// webpack.config.js での最適化例
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;path&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MiniCssExtractPlugin</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;mini-css-extract-plugin&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>BundleAnalyzerPlugin</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;webpack-bundle-analyzer&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>CompressionPlugin</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;compression-webpack-plugin&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>mode</span><span class=o>:</span> <span class=s1>&#39;production&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>optimization</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>splitChunks</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>chunks</span><span class=o>:</span> <span class=s1>&#39;all&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>cacheGroups</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>vendor</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>test</span><span class=o>:</span> <span class=sr>/[\\/]node_modules[\\/]/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;vendors&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>chunks</span><span class=o>:</span> <span class=s1>&#39;all&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>common</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>minChunks</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>chunks</span><span class=o>:</span> <span class=s1>&#39;all&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>enforce</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>plugins</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=c1>// CSS 抽出
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>new</span> <span class=nx>MiniCssExtractPlugin</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>filename</span><span class=o>:</span> <span class=s1>&#39;css/[name].[contenthash].css&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>chunkFilename</span><span class=o>:</span> <span class=s1>&#39;css/[id].[contenthash].css&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// バンドル分析
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>new</span> <span class=nx>BundleAnalyzerPlugin</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>analyzerMode</span><span class=o>:</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>ANALYZE</span> <span class=o>?</span> <span class=s1>&#39;server&#39;</span> <span class=o>:</span> <span class=s1>&#39;disabled&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Gzip 圧縮
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>new</span> <span class=nx>CompressionPlugin</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>algorithm</span><span class=o>:</span> <span class=s1>&#39;gzip&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>test</span><span class=o>:</span> <span class=sr>/\.(js|css|html|svg)$/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>threshold</span><span class=o>:</span> <span class=mi>8192</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>minRatio</span><span class=o>:</span> <span class=mf>0.8</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=まとめ>まとめ</h2><p>パフォーマンス最適化は、ユーザーエクスペリエンスの向上とビジネス成果の直結する重要な要素です。</p><h3 id=主要な最適化ポイント>主要な最適化ポイント</h3><ul><li><strong>Critical CSS</strong>: ファーストビューの高速表示</li><li><strong>画像最適化</strong>: 次世代フォーマットと遅延読み込み</li><li><strong>レンダリング最適化</strong>: レイアウトシフトの最小化</li><li><strong>バンドル最適化</strong>: 未使用コードの削除と分割読み込み</li><li><strong>キャッシュ戦略</strong>: Service Worker による効率的なキャッシュ</li></ul><h3 id=継続的な改善プロセス>継続的な改善プロセス</h3><ul><li>パフォーマンス指標の定期的な測定</li><li>Core Web Vitals の監視と改善</li><li>ユーザーフィードバックの収集と分析</li><li>新技術・手法の継続的な導入</li></ul><h3 id=開発ワークフローへの統合>開発ワークフローへの統合</h3><ul><li>ビルド時の自動最適化</li><li>パフォーマンス回帰の検出</li><li>ステージング環境でのパフォーマンステスト</li><li>本番環境でのリアルタイム監視</li></ul><p>パフォーマンス最適化は一度きりの作業ではなく、継続的な改善プロセスです。ユーザーの期待値の向上と新技術の登場に合わせて、常に最新の最適化手法を取り入れていくことが重要です。</p><p><strong>次回の記事では</strong>、「CSS実践入門第10回：SEO・アクセシビリティ」について解説予定です。検索エンジンに最適化され、すべてのユーザーにアクセシブルなWebサイトの構築方法を詳しく紹介します。</p><hr><p><strong>関連記事</strong>:</p><ul><li><a class=link href=/post/css-series-08-widget-system/>CSS実践入門第8回：ウィジェットシステム構築</a></li><li><a class=link href=/post/css-series-07-animations-transitions/>CSS実践入門第7回：アニメーション・トランジション実装</a></li><li><a class=link href=/post/css-series-06-javascript-search-engine/>CSS実践入門第6回：JavaScript検索エンジン実装</a></li></ul><div class="ad-container ad-briefs_bottom"></div><style>.ad-container{margin:16px 0}.ad-placeholder{background:var(--card-background);border:1px dashed var(--card-border-color);color:var(--card-text-color-secondary);border-radius:8px;padding:12px;text-align:center;font-size:.9rem}</style></section><footer class=article-footer><section class=article-tags><a href=/tags/css/>CSS</a>
<a href=/tags/%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9%E6%9C%80%E9%81%A9%E5%8C%96/>パフォーマンス最適化</a>
<a href=/tags/critical-css/>Critical CSS</a>
<a href=/tags/%E7%94%BB%E5%83%8F%E6%9C%80%E9%81%A9%E5%8C%96/>画像最適化</a>
<a href=/tags/%E3%83%AC%E3%83%B3%E3%83%80%E3%83%AA%E3%83%B3%E3%82%B0%E6%9C%80%E9%81%A9%E5%8C%96/>レンダリング最適化</a>
<a href=/tags/web-vitals/>Web Vitals</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>関連するコンテンツ</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80%E7%AC%AC8%E5%9B%9E%E3%82%A6%E3%82%A3%E3%82%B8%E3%82%A7%E3%83%83%E3%83%88%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E6%A7%8B%E7%AF%89-%E5%86%8D%E5%88%A9%E7%94%A8%E5%8F%AF%E8%83%BD%E3%81%AA%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E8%A8%AD%E8%A8%88/><div class=article-details><h2 class=article-title>CSS実践入門第8回：ウィジェットシステム構築 - 再利用可能なコンポーネント設計</h2></div></a></article><article><a href=/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80%E7%AC%AC7%E5%9B%9E%E3%82%A2%E3%83%8B%E3%83%A1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B8%E3%82%B7%E3%83%A7%E3%83%B3%E5%AE%9F%E8%A3%85-%E6%BB%91%E3%82%89%E3%81%8B%E3%81%AA%E5%8B%95%E3%81%8D%E3%81%A7%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E4%BD%93%E9%A8%93%E3%82%92%E5%90%91%E4%B8%8A/><div class=article-details><h2 class=article-title>CSS実践入門第7回：アニメーション・トランジション実装 - 滑らかな動きでユーザー体験を向上</h2></div></a></article><article><a href=/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80-%234%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B7%E3%83%96%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%E5%AE%8C%E5%85%A8%E3%82%AC%E3%82%A4%E3%83%89-%E3%81%82%E3%82%89%E3%82%86%E3%82%8B%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9%E3%81%AB%E5%AF%BE%E5%BF%9C%E3%81%99%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E4%BD%9C%E3%82%8B/><div class=article-details><h2 class=article-title>【CSS実践入門 #4】レスポンシブデザイン完全ガイド - あらゆるデバイスに対応するサイトを作る</h2></div></a></article><article><a href=/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80-%233flexbox%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88%E5%85%A5%E9%96%80-3%E3%82%AB%E3%83%A9%E3%83%A0%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%AE%9F%E8%A3%85%E3%81%99%E3%82%8B/><div class=article-details><h2 class=article-title>【CSS実践入門 #3】Flexboxレイアウト入門 - 3カラムレイアウトを実装する</h2></div></a></article><article><a href=/post/css%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80-%232css%E3%82%BB%E3%83%AC%E3%82%AF%E3%82%BF%E3%81%A8%E3%82%AB%E3%82%B9%E3%82%B1%E3%83%BC%E3%83%89-%E6%80%9D%E3%81%84%E9%80%9A%E3%82%8A%E3%81%AB%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E9%81%A9%E7%94%A8%E3%81%99%E3%82%8B%E6%8A%80%E8%A1%93/><div class=article-details><h2 class=article-title>【CSS実践入門 #2】CSSセレクタとカスケード - 思い通りにスタイルを適用する技術</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 -
2026 トミー</section><section class=powerby>技術ネタ、趣味や備忘録などを書いているブログです<br><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> で構築されています。<br>テーマ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> は <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> によって設計されています。</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><footer class=site-footer><div class=footer-container><div class=footer-content><div class=footer-section><h3 class=footer-title>firebirdテックトーク</h3><p class=footer-description>技術ネタ、趣味や備忘録などを書いているブログです</p><div class=footer-social><a href=https://twitter.com/firebird19245 class=social-link target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></div></div><div class=footer-section><h3 class=footer-title>カテゴリー</h3><ul class=footer-links><li><a href=/categories/%E3%83%9E%E3%82%A4%E3%83%96%E3%83%AD%E3%82%B0/>マイブログ (87)</a></li><li><a href=/categories/%E6%97%85%E8%A1%8C%E8%A8%98/>旅行記 (15)</a></li></ul></div><div class=footer-section><h3 class=footer-title>人気タグ</h3><div class=footer-tags><a href=/tags/author-created/ class=tag-link>Author-Created
<span class=tag-count>54</span>
</a><a href=/tags/gcp/ class=tag-link>Gcp
<span class=tag-count>27</span>
</a><a href=/tags/ai/ class=tag-link>AI
<span class=tag-count>10</span>
</a><a href=/tags/network/ class=tag-link>Network
<span class=tag-count>9</span>
</a><a href=/tags/security/ class=tag-link>Security
<span class=tag-count>8</span>
</a><a href=/tags/vpc/ class=tag-link>VPC
<span class=tag-count>8</span>
</a><a href=/tags/css/ class=tag-link>CSS
<span class=tag-count>7</span>
</a><a href=/tags/devops/ class=tag-link>DevOps
<span class=tag-count>7</span>
</a><a href=/tags/grpc/ class=tag-link>GRPC
<span class=tag-count>7</span>
</a><a href=/tags/%E6%97%85%E8%A1%8C/ class=tag-link>旅行
<span class=tag-count>6</span></a></div></div><div class=footer-section><h3 class=footer-title>アーカイブ</h3><ul class=footer-links><li><a href=/archives/#2026>2026年 (5)</a></li><li><a href=/archives/#2025>2025年 (97)</a></li><li><a href=/archives/#2024>2024年 (2)</a></li><li><a href=/archives/#0001>0001年 (4)</a></li></ul></div><div class=footer-section><h3 class=footer-title>このサイトについて</h3><ul class=footer-links><li><a href=/about/>サイトについて</a></li><li><a href=/privacy/>プライバシーポリシー</a></li><li><a href=/sitemap.xml>サイトマップ</a></li><li><a href=/index.xml>RSS</a></li></ul></div></div><div class=footer-bottom><div class=footer-copyright><p>&copy; 2026 firebirdテックトーク. All rights reserved.</p></div></div></div></footer><style>.site-footer{background:var(--card-background);border-top:1px solid var(--card-separator-color);margin-top:60px;padding:40px 0 20px}.footer-container{max-width:1200px;margin:0 auto;padding:0 20px}.footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:40px;margin-bottom:40px}.footer-section{display:flex;flex-direction:column}.footer-title{color:var(--card-text-color-main);font-size:1.1em;font-weight:600;margin:0 0 20px;padding-bottom:10px;border-bottom:2px solid var(--accent-color)}.footer-description{color:var(--card-text-color-secondary);line-height:1.6;margin-bottom:20px}.footer-links{list-style:none;padding:0;margin:0}.footer-links li{margin-bottom:8px}.footer-links a{color:var(--card-text-color-secondary);text-decoration:none;font-size:.9em;transition:color .2s}.footer-links a:hover{color:var(--accent-color)}.footer-social{display:flex;gap:12px;flex-wrap:wrap}.social-link{display:flex;align-items:center;justify-content:center;width:36px;height:36px;background:var(--card-separator-color);border-radius:50%;color:var(--card-text-color-secondary);text-decoration:none;transition:all .2s}.social-link:hover{background:var(--accent-color);color:#fff}.footer-tags{display:flex;flex-wrap:wrap;gap:8px}.tag-link{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;background:var(--card-separator-color);border-radius:4px;color:var(--card-text-color-secondary);text-decoration:none;font-size:.8em;transition:all .2s}.tag-link:hover{background:var(--accent-color-light);color:var(--accent-color)}.tag-count{background:var(--accent-color);color:#fff;padding:1px 4px;border-radius:3px;font-size:.7em;font-weight:700}.footer-bottom{padding-top:20px;border-top:1px solid var(--card-separator-color);text-align:center}.footer-copyright{color:var(--card-text-color-tertiary);font-size:.8em}.footer-copyright p{margin:4px 0}@media(max-width:768px){.site-footer{padding:30px 0 15px;margin-top:40px}.footer-container{padding:0 15px}.footer-content{grid-template-columns:1fr;gap:30px;margin-bottom:30px}.footer-section{text-align:center}.footer-links{display:flex;flex-wrap:wrap;justify-content:center;gap:15px}.footer-tags{justify-content:center}.footer-social{justify-content:center}}</style><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>